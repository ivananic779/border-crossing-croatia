<h2 class="text-center">Granična statistika Republike Hrvatske</h2>


<h3 *ngIf="this.chart_data.length == 0" class="text-danger text-center">Greška u upitu, provjerite datume i jesu li su sva polja ispunjenja.</h3>

<div class="card">
    <div class="card-body row">
        <div class="col-sm-12" style="height: calc(100vh - 16px);">
            <ngx-charts-line-chart *ngIf="this.chart_data.length > 0" [schemeType]="this.scheme_type"
                [animations]="true" [timeline]="true" [autoScale]="true" [gradient]="false" [tooltipDisabled]="false"
                [legend]="true" [legendTitle]="this.legend_title" [legendPosition]="this.legend_position" [xAxis]="true"
                [showXAxisLabel]="true" [xAxisLabel]="'Datum'" [trimXAxisTicks]="true" [rotateXAxisTicks]="true"
                [maxXAxisTickLength]="16" [yAxis]="true" [showYAxisLabel]="true" [yAxisLabel]="'Broj'"
                [trimYAxisTicks]="true" [rotateXAxisTicks]="true" [maxYAxisTickLength]="16" [results]="this.chart_data"
                [roundDomains]="false" (select)="select($event)" (activate)="activate($event)"
                (deactivate)="deactivate($event)">
            </ngx-charts-line-chart>
            <br>
            <br>
            <div class="row">
                <button class="btn btn-outline-primary" type="button" (click)="edit_line()">Uredi linije</button>
            </div>
            <br>
            <div class="row">
                <button class="btn btn-outline-danger" type="button" (click)="delete_all_lines()">Obriši sve</button>
            </div>
        </div>
    </div>
</div>

<p-dialog [modal]="true" [(visible)]="displayRequestOptionsDialog" [style]="{height: 'calc(100vh - 50px)', width: '150vh'}">
    <p-header>
        <div class="row">
            <div class="col-sm-12">
                <h3>Linije grafa</h3>
            </div>
        </div>
    </p-header>
    <p-table responsiveLayout="stack" [value]="requestOptions">
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th>Naziv</th>
                <th>Datum od</th>
                <th>Datum do</th>
                <th>Tablica</th>
                <th>Tip prikaza</th>
                <th>Obriši</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-requestOption let-columns="columns">
            <tr>
                <td><span class="p-column-title">Naziv</span>
                    <input type="text" [(ngModel)]="requestOption.name">
                </td>
                <td><span class="p-column-title">Datum od</span>
                    <input type="date" min="2012-01-01" [(ngModel)]="requestOption.date_from">
                </td>
                <td><span class="p-column-title">Datum do</span>
                    <input type="date" [(ngModel)]="requestOption.date_to">
                </td>
                <td><span class="p-column-title">Tablica</span>
                    <select name="selectomundo" [(ngModel)]="requestOption.table">
                        <option *ngFor="let table of table_list">{{table}}</option>
                    </select>
                </td>
                <td><span class="p-column-title">Tip prikaza</span>
                    <select name="selectomundo" [(ngModel)]="requestOption.query_type">
                        <option *ngFor="let graph_type of graph_types">{{graph_type}}</option>
                    </select>
                </td>
                <td><span class="p-column-title">Obriši</span>
                    <button class="btn btn-danger" (click)="remove_line(requestOption)">Obriši</button>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <div class="row">
        <button class="btn btn-primary" type="button" (click)="add_new_line()">Dodaj</button>
    </div>
    <ng-template pTemplate="footer">
        <p-button icon="pi pi-times" (click)="displayRequestOptionsDialog=false;" label="Odustani" styleClass="p-button-text text-danger"></p-button>
        <p-button icon="pi pi-check" (click)="refresh()" label="Spremi" styleClass="p-button-success"></p-button>
    </ng-template>
</p-dialog>

<p-dialog [modal]="true" [(visible)]="displayFormWarningDialog">
    <p class="text-danger text-center">Greška u formi.</p>
    <p>Datum svake linije mora počinjati i završavati unutar iste godine.</p>
    <p>Sva polja na linijama moraju biti popunjena.</p>
    <p>Polja ne smiju imati isti naziv.</p>
</p-dialog>